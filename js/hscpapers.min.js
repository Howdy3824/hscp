function urlParam(o){var e=new RegExp("[?&]"+o+"=([^&#]*)").exec(window.location.href);return null===e?"":decodeURIComponent(e[1])}function urlNotFound(o){function e(o,e,a){a?r.append('<tr class="error"><td>'+o+"</td><td>"+e+"</td></tr>"):r.append("<tr><td>"+o+"</td><td>"+e+"</td></tr>")}var r=$("#not-found-modal-table"),a=$("#not-found-modal-type");r.html(""),a.html(""),a.html(o),"Course"==o?e("Course",urlCourse,!0):"Year"==o?(e("Course",urlCourse,!1),e("Year",urlYear,!0)):"Doc"==o&&(e("Course",urlCourse,!1),e("Year",urlYear,!1),e("Doc",urlDoc,!0)),$("#not-found-modal").modal({duration:200,onApprove:function(){urlCourse="",urlYear="",urlDoc="",setTimeout(function(){$("#"+o.toLowerCase()+"-dropdown").dropdown("show")},200)}}).modal("show")}function populateDropdown(o,e,r,a){var d=[];for(i=0;i<o.length;i++)d.push(o[i][e]);for(d.sort(),a&&d.reverse(),$(r).empty(),j=0;j<d.length;j++)$(r).append('<div class="item" data-value"1">'+d[j]+"</div>")}var jsonData,courseIndex,yearIndex,docLink,urlCourse,urlYear,urlDoc,selectedCourse,selectedYear,selectedDoc,params;$(document).ready(function(){$("#nojquery").hide(),urlCourse=urlParam("course"),urlYear=urlParam("year"),urlDoc=urlParam("doc"),"about"==urlParam("open")&&$("#about-modal").modal("show"),params={course:"",year:"",doc:""},$("#more-dropdown").dropdown({action:"nothing"}),$.getJSON("https://raw.githubusercontent.com/notseenee/nesappscraper/master/data.json",function(o){populateDropdown(jsonData=o,"course_name","#course-menu",!1),$("#loader").removeClass("active"),$("#loadingmsg").hide(),$("#course-dropdown").removeClass("disabled").dropdown("show").dropdown({selectOnKeydown:!1}),urlCourse&&($("#course-dropdown").dropdown("set selected",urlCourse).dropdown("hide"),$("#course-dropdown").dropdown("get value")||urlNotFound("Course"))}),$.getJSON("https://raw.githubusercontent.com/notseenee/nesappscraper/master/meta.json",function(o){console.log(o.timestamp),$("#timestamp").html(o.timestamp.replace("T"," ").substring(0,19))}),$(".popup").popup(),$("#about-modal").modal({duration:200})}),$("#course-input").change(function(){for(selectedCourse=$("#course-input")[0].value,params.course=selectedCourse,$("#year-dropdown").addClass("loading").removeClass("disabled"),k=0;k<jsonData.length;k++)if(jsonData[k].course_name.toLowerCase()==selectedCourse){courseIndex=k;break}populateDropdown(jsonData[courseIndex].packs,"year","#year-menu",!0),$("#year-dropdown").removeClass("loading").dropdown("restore defaults").dropdown("show").dropdown({selectOnKeydown:!1}),urlYear&&($("#year-dropdown").dropdown("set selected",urlYear).dropdown("hide"),$("#year-dropdown").dropdown("get value")||urlNotFound("Year")),history.pushState(null,"","?"+$.param(params))}),$("#year-input").change(function(){if(""!=$(this)[0].value){for(selectedYear=$("#year-input")[0].value,params.year=selectedYear,$("#doc-dropdown").addClass("loading").removeClass("disabled"),l=0;l<jsonData[courseIndex].packs.length;l++)if(jsonData[courseIndex].packs[l].year==selectedYear){yearIndex=l;break}populateDropdown(jsonData[courseIndex].packs[yearIndex].docs,"doc_name","#doc-menu",!1),$("#doc-dropdown").removeClass("loading").dropdown("restore defaults").dropdown("show"),urlDoc&&($("#doc-dropdown").dropdown("set selected",urlDoc).dropdown("hide"),$("#doc-dropdown").dropdown("get value")||urlNotFound("Doc")),$(".button-exampack").removeClass("disabled").attr("href",jsonData[courseIndex].packs[yearIndex].link),history.pushState(null,"","?"+$.param(params))}}),$("#doc-input").change(function(){if(""!=$(this)[0].value){for(selectedDoc=$("#doc-input")[0].value,params.doc=selectedDoc,m=0;m<jsonData[courseIndex].packs[yearIndex].docs.length;m++)if(jsonData[courseIndex].packs[yearIndex].docs[m].doc_name.toLowerCase()==selectedDoc){docLink=jsonData[courseIndex].packs[yearIndex].docs[m].doc_link,docLink=docLink.replace("http","https");break}$("#iframe").attr("src",docLink),$("#loader").addClass("active"),$(".button-download").removeClass("disabled").attr("href",docLink),$(".button-link").removeClass("disabled").removeAttr("disabled"),$("#pdf-dropdown").removeClass("disabled").dropdown({action:"nothing"}),history.pushState(null,"","?"+$.param(params)),document.title=$("#year-dropdown .text").html()+" "+$("#doc-dropdown .text.overflow").html()+" - "+$("#course-dropdown .text").html()}}),$(".button-link").click(function(){prompt("Copy link below:",docLink)}),$(".button-about").click(function(){$("#about-modal").modal("show")}),$("#iframe").on("load",function(){$("#loader").removeClass("active")});